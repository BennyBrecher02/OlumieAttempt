---
const isDev = import.meta.env.DEV;
if (!isDev) {
  // Never render this in production builds
  return null as unknown as any;
}
---

<button
  type="button"
  data-dev-theme-toggle
  class="fixed bottom-4 right-4 z-[100] inline-flex items-center gap-2 rounded-full border border-border bg-card/85 px-3 py-2 text-xs font-semibold text-muted shadow-sm backdrop-blur transition hover:bg-card hover:text-fg"
  aria-label="Toggle theme"
>
  <span aria-hidden="true">Theme</span>
  <span data-dev-theme-icon aria-hidden="true" class="text-sm leading-none">☀︎</span>
</button>

<script is:inline>
  (() => {
    const storageKey = "theme";
    const root = document.documentElement;
    const btn = document.querySelector("[data-dev-theme-toggle]");
    const icon = document.querySelector("[data-dev-theme-icon]");

    if (!btn || !icon) return;

    const getTheme = () => (root.dataset.theme === "dark" ? "dark" : "light");
    const setTheme = (t) => {
      root.dataset.theme = t;
      icon.textContent = t === "dark" ? "☾" : "☀︎";
    };

    // Initialize icon from current DOM state
    setTheme(getTheme());

    btn.addEventListener("click", () => {
      const next = getTheme() === "dark" ? "light" : "dark";
      localStorage.setItem(storageKey, next);
      setTheme(next);
    });
  })();
</script>

